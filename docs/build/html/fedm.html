
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>fedm package &#8212; FEDM - Finite Element Discharge Modelling code 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'fedm';</script>
    <link rel="icon" href="_static/logo_small.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo_small.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo_small.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contribution.html">
                        Contributing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="indices_and_tables.html">
                        Index
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="acknowledgment.html">
                        Acknowledgment
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contact.html">
                        Contact
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/INP-PM/FEDM" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.inp-greifswald.de/en/" title="INP" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-building-columns"></i></span>
            <label class="sr-only">INP</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contribution.html">
                        Contributing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="indices_and_tables.html">
                        Index
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="acknowledgment.html">
                        Acknowledgment
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contact.html">
                        Contact
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/INP-PM/FEDM" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.inp-greifswald.de/en/" title="INP" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-building-columns"></i></span>
            <label class="sr-only">INP</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">fedm package</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="fedm-package">
<h1>fedm package<a class="headerlink" href="#fedm-package" title="Permalink to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-fedm.file_io">
<span id="fedm-file-io-module"></span><h2>fedm.file_io module<a class="headerlink" href="#module-fedm.file_io" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fedm.file_io.Files">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">Files</span></span><a class="headerlink" href="#fedm.file_io.Files" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Files class provides access to the files and directories used by FEDM. It should
normally be accessed via the global instance <cite>fedm.files</cite>.</p>
<p>It has the following attributes:</p>
<dl class="simple">
<dt>– file_input: Directory containing input files, default ‘./file_input’. Can be</dt><dd><p>assigned to a new path. Throws an error if the new path doesn’t exist.</p>
</dd>
<dt>– output_folder_path: Directory which will contain output files, default ‘./output’.</dt><dd><p>Can be assigned to a new path. This will create a new directory if it doesn’t
already exist.</p>
</dd>
<dt>– error_file: File storing relative errors. Cannot be assigned, and will always</dt><dd><p>return ‘output_folder_path/relative error.log’. The first time the user accesses
it per run, the file will be created/truncated.</p>
</dd>
<dt>– model_log: File storing logs describing the run. Cannot be assigned, and will</dt><dd><p>always return ‘output_folder_path/model.log’. The first time the user accesses
it per run, the file will be created/truncated.</p>
</dd>
</dl>
<p>Examples:</p>
<p>– Assign a new value to file_input (folder must exist)
files.file_input = “my_file_input”
– Get the current value of output_folder_path
output = files.output_folder_path
– Get error file (first access will truncate the file)
error_file = files.error_file</p>
<dl class="py property">
<dt class="sig sig-object py" id="fedm.file_io.Files.error_file">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">error_file</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#fedm.file_io.Files.error_file" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fedm.file_io.Files.file_input">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">file_input</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#fedm.file_io.Files.file_input" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fedm.file_io.Files.model_log">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model_log</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#fedm.file_io.Files.model_log" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fedm.file_io.Files.output_folder_path">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_folder_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#fedm.file_io.Files.output_folder_path" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.decomment">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">decomment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fedm.file_io.decomment" title="Permalink to this definition">#</a></dt>
<dd><p>Removes comment at end of each line, denoted with ‘#’. If the line is blank, or the
line starts with a ‘#’, returns an empty string. Works as a generator function.
Code snippet addapted from:
<a class="reference external" href="https://stackoverflow.com/questions/14158868/python-skip-comment-lines-marked-with-in-csv-dictreader">https://stackoverflow.com/questions/14158868/python-skip-comment-lines-marked-with-in-csv-dictreader</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.file_output">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">file_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_old1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.file_output" title="Permalink to this definition">#</a></dt>
<dd><p>Writing value of desired variable to file. Value is calculated by linear
interpolation.  Input arguments are current time step, previous time step, current
time step length, previous time step length, list of output times, list of steps
(which needs have same size), list of output files, list of variable values in
current and previous time steps, and (optional) units of time.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.flatten">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.file_io.flatten" title="Permalink to this definition">#</a></dt>
<dd><p>Reduces 2D list to 1D list.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.flatten_float">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">flatten_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.file_io.flatten_float" title="Permalink to this definition">#</a></dt>
<dd><p>Reduces 2D list to 1D list and converts elements to float.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.log">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_file_name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.log" title="Permalink to this definition">#</a></dt>
<dd><p>The function is used to log model data and its progress.
The input arguments vary depending on the type of logging.
For type = properties, input are gas, model, particle species
names, particle mass, and charge.
For type = conditions, input arguments are time step length,
working voltage, pressure, gap length, gas number density,
and gas temperature.
For type = matrices, input arguments are gain, loss and power
matrices.
For type = initial_time, input argument is time.
For type = time, input argument is time.
For type = mesh, input argument is mesh.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.mesh_statistics">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">mesh_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mesh</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fedm.file_io.mesh_statistics" title="Permalink to this definition">#</a></dt>
<dd><p>Returns mesh size and, maximum and minimum element size.
Input is mesh.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.no_convert">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">no_convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#fedm.file_io.no_convert" title="Permalink to this definition">#</a></dt>
<dd><p>This utility function is used in functions that may optionally try to convert
inputs to a given type. ‘no_convert’ may be used in place of ‘float’, ‘str’, etc
to prevent the function from converting types.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.numpy_2d_array_to_str">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">numpy_2d_array_to_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fedm.file_io.numpy_2d_array_to_str" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.output_files">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">output_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_of_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.file_io.output_files" title="Permalink to this definition">#</a></dt>
<dd><p>Creates desired number of output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_type</strong> (<em>str</em>) – ‘pvd’ or ‘xdmf’</p></li>
<li><p><strong>type_of_output</strong> (<em>str</em>) – Name of folder where files should be saved</p></li>
<li><p><strong>output_file_names</strong> – List of files to create</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.print_time">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">print_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.print_time" title="Permalink to this definition">#</a></dt>
<dd><p>Prints time.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.print_time_step">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">print_time_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.print_time_step" title="Permalink to this definition">#</a></dt>
<dd><p>Prints time step.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.rate_coefficient_file_names">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">rate_coefficient_file_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.rate_coefficient_file_names" title="Permalink to this definition">#</a></dt>
<dd><p>Reads names of reaction coefficient files from “reacscheme.cfg” file.
Input parameter is the path to the folder.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.reaction_matrices">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">reaction_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.reaction_matrices" title="Permalink to this definition">#</a></dt>
<dd><p>Reads the reaction scheme from “reacscheme.cfg” file and creates power, loss and
gain matrices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_and_decomment">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_and_decomment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.file_io.read_and_decomment" title="Permalink to this definition">#</a></dt>
<dd><p>Reads file, returns list of strings. Comment lines and blank lines are removed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_dependence">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_dependence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_dependence" title="Permalink to this definition">#</a></dt>
<dd><p>Reads dependence of rate coefficients from the corresponding file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_dependences">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_dependences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_if_file_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_dependences" title="Permalink to this definition">#</a></dt>
<dd><p>Reads dependence of rate coefficients from a list of corresponding files.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_energy_loss">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_energy_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_energy_loss" title="Permalink to this definition">#</a></dt>
<dd><p>Reads energy loss values from “reacscheme.cfg” file.
Input argument is the path to the folder.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_particle_properties">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_particle_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_particle_properties" title="Permalink to this definition">#</a></dt>
<dd><p>Reads particle properties from input file.
Input are file names and model.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_rate_coefficients">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_rate_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc_file_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_dependences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_rate_coefficients" title="Permalink to this definition">#</a></dt>
<dd><p>Reading rate coefficients from files. Input are file names and dependences.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_single_float">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_single_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert=&lt;function</span> <span class="pre">no_convert&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_single_float" title="Permalink to this definition">#</a></dt>
<dd><p>Reads file containing only constant.
Input parameter is file name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_single_string">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_single_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_single_string" title="Permalink to this definition">#</a></dt>
<dd><p>Reads file containing one column.
Input parameter is file name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_single_value">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_single_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert=&lt;function</span> <span class="pre">no_convert&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_single_value" title="Permalink to this definition">#</a></dt>
<dd><p>Reads file containing only constant.
Input parameter is file name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_speclist">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_speclist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_speclist" title="Permalink to this definition">#</a></dt>
<dd><p>Function reads list of species from ‘speclist.cfg’ file
and extracts species names and species properties filename.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_transport_coefficients">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_transport_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particle_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transport_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_transport_coefficients" title="Permalink to this definition">#</a></dt>
<dd><p>Reading transport coefricients from files. Input are
particle names, type of transport coefficient (diffusion or mobility)
and model.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.read_two_columns">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">read_two_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.file_io.read_two_columns" title="Permalink to this definition">#</a></dt>
<dd><p>Reads two column files.
Input parameter is file name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.file_io.truncate_file">
<span class="sig-prename descclassname"><span class="pre">fedm.file_io.</span></span><span class="sig-name descname"><span class="pre">truncate_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fedm.file_io.truncate_file" title="Permalink to this definition">#</a></dt>
<dd><p>Deletes contents of file, leaving it as an empty file.
If the file does not exist, creates the empty file and any directories up to it.</p>
</dd></dl>

</section>
<section id="module-fedm.functions">
<span id="fedm-functions-module"></span><h2>fedm.functions module<a class="headerlink" href="#module-fedm.functions" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.BoundaryGradient">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">BoundaryGradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeroDomain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_extract</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.854187817e-12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.BoundaryGradient" title="Permalink to this definition">#</a></dt>
<dd><p>The function is an adaptation of the code snippet by D. Kamensky from
<a class="reference external" href="https://fenicsproject.discourse.group/t/compute-gradient-of-scalar-field-on-boundarymesh/1172/2">https://fenicsproject.discourse.group/t/compute-gradient-of-scalar-field-on-boundarymesh/1172/2</a>.
It is used for the accurate calculation of the flux (in this case the electric
field) across the specific boundary. Input parameters are variables whose gradient
needs to be determined, marker of the whole domain except the boundary on which
flux is calculated, the source term of the equation, list of ds of the specific
boundaries (irrelevant boundaries should be marked as zero).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Boundary_flux">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Boundary_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bc_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equation_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_temp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Measure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.15915494309189535</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ion_flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.Boundary_flux" title="Permalink to this definition">#</a></dt>
<dd><p>Function defines boundary conditions for different equations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux'</strong> (<em>Type</em><em> of </em><em>boundary condition. Options are 'zero</em>) – </p></li>
<li><p><strong>'Neumann'</strong> (<em>'flux source' or</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>equation_type<span class="classifier">str</span></dt><dd><p>Choices are ‘reaction’, ‘diffusion-reaction’ or ‘drift-diffusion-reaction’</p>
</dd>
<dt>particle_type<span class="classifier">str</span></dt><dd><p>Choices are ‘Heavy’ or ‘electrons’.</p>
</dd>
<dt>sign: float</dt><dd><p>Particle charge sign</p>
</dd>
<dt>mu: df.Function</dt><dd><p>Mobility</p>
</dd>
<dt>E</dt><dd><p>Electric field, Dolfin ComponentTensor</p>
</dd>
<dt>normal</dt><dd><p>Dolfin FacetNormal</p>
</dd>
<dt>u</dt><dd><p>Trial function</p>
</dd>
<dt>gamma</dt><dd><p>Secondary electron emission coefficient</p>
</dd>
<dt>v</dt><dd><p>Test function</p>
</dd>
<dt>ds_temp<span class="classifier">df.Measure</span></dt><dd><p>ds, surface element used to build integrals (??)</p>
</dd>
<dt>r: float, default 0.5/pi</dt><dd><p>r coordinate</p>
</dd>
<dt>vth: float, default 0.0</dt><dd><p>Thermal velocity</p>
</dd>
<dt>ref: float, default 1.0</dt><dd><p>Reflection coefficient for specified particles species and boundary.</p>
</dd>
<dt>Ion_flux: float, default 0.0</dt><dd><p>Flux of ions</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>df.Form</em> – If bc_type is ‘flux source’ and there is a diffusion term in equation_type.
Also if the user combines Neumann boundaries with a drift-diffusion-reaction
equation.</p></li>
<li><p><em>float</em> – Otherwise.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If bc_type is not recognised. If bc_type is not ‘zero flux’, also raised if
    equation_type is not recognised. Furthermore, if equation_type is
    ‘drift-diffusion-reaction’, raises if particle_type is not recognised.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fedm.functions.CircleSubDomain">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">CircleSubDomain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.CircleSubDomain" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SubDomain</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="fedm.functions.CircleSubDomain.inside">
<span class="sig-name descname"><span class="pre">inside</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dolfin.cpp.mesh.SubDomain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">[</span></span><span class="pre">m</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#fedm.functions.CircleSubDomain.inside" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Energy_Source_term">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Energy_Source_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coupling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_coeffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Function</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ei</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.functions.Energy_Source_term" title="Permalink to this definition">#</a></dt>
<dd><p>Defines energy source term for LMEA approximation. Function arguments
are power, loss and gain matrices, rate coeffiients, energy losses for specific
process, mean electron energy, gas number density and particle number density
variable.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="fedm.functions.ErrorGreaterThanTTOL">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">ErrorGreaterThanTTOL</span></span><a class="headerlink" href="#fedm.functions.ErrorGreaterThanTTOL" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Flux">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sign</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_diffusion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logarithm_representation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.Flux" title="Permalink to this definition">#</a></dt>
<dd><p>Defines particle flux using drift-diffusion approximation.
Input arguments are particle charge, number density,
diffusion coefficient, mobility and electric field. The additional
arguments are used to specify if the gradient of the diffusion
should be considered and whether logarithmic representation
is used.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Function_definition">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Function_definition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FunctionSpace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.functions.Function_definition" title="Permalink to this definition">#</a></dt>
<dd><p>Defines list of desired function type (TrialFunction, TestFunction or ordinary
Function). Input arguments are function space, type of desired function and number
of equations, where the default value is one.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Function_space_list">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Function_space_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number_of_equations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FunctionSpace</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">FunctionSpace</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.functions.Function_space_list" title="Permalink to this definition">#</a></dt>
<dd><p>Defines list of function spaces. Input arguments are number of equations and
function space.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fedm.functions.LineSubDomain">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">LineSubDomain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.LineSubDomain" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SubDomain</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="fedm.functions.LineSubDomain.inside">
<span class="sig-name descname"><span class="pre">inside</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dolfin.cpp.mesh.SubDomain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">[</span></span><span class="pre">m</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#fedm.functions.LineSubDomain.inside" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Marking_boundaries">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Marking_boundaries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundaries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MeshFunction</span></span></span><a class="headerlink" href="#fedm.functions.Marking_boundaries" title="Permalink to this definition">#</a></dt>
<dd><p>Marking boundaries of a provided mesh. Currently, straight-line and circular
boundaries are supported. First argument is the mesh, the second argument is a list
of boundary properties (boundary type and coordinates).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Max">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.Max" title="Permalink to this definition">#</a></dt>
<dd><p>Returns maximum value of a and b.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Min">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.Min" title="Permalink to this definition">#</a></dt>
<dd><p>Returns minimum value of a and b.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Mixed_element_list">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Mixed_element_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number_of_equations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FiniteElement</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">FiniteElement</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.functions.Mixed_element_list" title="Permalink to this definition">#</a></dt>
<dd><p>Defines list of mixed elements. Input arguments are number of equations and element
type.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Normal_vector">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Normal_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mesh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.Normal_vector" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Poisson_solver">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Poisson_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mumps'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preconditioner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hypre_amg'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.Poisson_solver" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fedm.functions.Problem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Problem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.Problem" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NonlinearProblem</span></code></p>
<p>Nonlinear problem definition. Input parameters are F - weak form of the equation
J - Jacobian and bcs -Dirichlet boundary conditions. The part of code is provided
by user Nate Sime from FEniCS forum:
<a class="reference external" href="https://fenicsproject.discourse.group/t/set-krylov-linear-solver-paramters-in-newton-solver/1070/3">https://fenicsproject.discourse.group/t/set-krylov-linear-solver-paramters-in-newton-solver/1070/3</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="fedm.functions.Problem.F">
<span class="sig-name descname"><span class="pre">F</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.Problem.F" title="Permalink to this definition">#</a></dt>
<dd><p>Linear form assembly</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fedm.functions.Problem.J">
<span class="sig-name descname"><span class="pre">J</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.Problem.J" title="Permalink to this definition">#</a></dt>
<dd><p>Bilinear form assembly</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Rate_coefficient_interpolation">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Rate_coefficient_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_coeffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Function</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kxs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redfield</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Te</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">300.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">300.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fedm.functions.Rate_coefficient_interpolation" title="Permalink to this definition">#</a></dt>
<dd><p>Function for linear interpolation of rate coefficients.</p>
<p>WARNING: When using the dependences ‘fun:Te,Tgas’ and ‘fun:Tgas’, this function
will evaluate the corresponding contents of ‘ky’ using ‘eval’. It is the user’s
responsibility to ensure no malicious code is injected here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<em>str</em>) – Possible values are ‘initial’ or ‘update’. The former should be used when
determining the initial definition.</p></li>
<li><p><strong>dependences</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – Possible values are ‘const’, ‘Umean’, ‘E/N’, ‘ESR’, or ‘Tgas’. Can also be set
to zero to skip this k_coeff.</p></li>
<li><p><strong>k_coeff</strong> (<em>List</em><em>[</em><em>df.Function</em><em>]</em>) – List of coefficient variables</p></li>
<li><p><strong>kx</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>) – Look-up table data</p></li>
<li><p><strong>ky</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>) – Look-up table data</p></li>
<li><p><strong>energy</strong> (<em>df.Function</em>) – Energy function</p></li>
<li><p><strong>redfield</strong> (<em>df.Function</em>) – Reduced electric field.</p></li>
<li><p><strong>Tgas</strong> (<em>float</em><em>, </em><em>default 300.0</em>) – Gas temperature. Not used directly, but may be used by user-supplied function.</p></li>
<li><p><strong>Te</strong> (<em>float</em><em>, </em><em>default 0.0</em>) – Electron temperature. Not used directly, but may be used by user-supplied
function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If given incorrect status or dependences, or if the provided lists are not all
    of the same length.</p></li>
<li><p><strong>Exception</strong> – The user may supply their own functions using the ‘fun:Te,Tgas’ or ‘fun:Tgas’
    dependences. These are evaluated using ‘eval’, meaning anything could happen.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Source_term">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Source_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coupling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_coeffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Function</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.functions.Source_term" title="Permalink to this definition">#</a></dt>
<dd><p>Defines source term for coupled or uncoupled approach, with
LFA (counting particles from 0) or LMEA approximation
(counting particle from 1 and the zeroth equation is energy).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coupling</strong> (<em>str</em>) – Either ‘coupled’ or ‘uncoupled’</p></li>
<li><p><strong>approx</strong> (<em>str</em>) – Either ‘LFA’ or ‘LMEA’</p></li>
<li><p><strong>p_matrix</strong> (<em>np.ndarray</em>) – Power matrix</p></li>
<li><p><strong>l_matrix</strong> (<em>np.ndarray</em>) – Loss matrix</p></li>
<li><p><strong>g_matrix</strong> (<em>np.ndarray</em>) – Gain matrix</p></li>
<li><p><strong>k_coeffs</strong> (<em>List</em><em>[</em><em>df.Function</em><em>]</em>) – Rate coefficient, energy loss and mean energy</p></li>
<li><p><strong>N0</strong> (<em>float</em>) – Gas number density</p></li>
<li><p><strong>u</strong> – Trial function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Source terms</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If coupling or approx are invalid. Could also be raised if the inputs have the
    wrong shapes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.Transport_coefficient_interpolation">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">Transport_coefficient_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_coeffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Function</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kxs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redfield</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Function</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fedm.functions.Transport_coefficient_interpolation" title="Permalink to this definition">#</a></dt>
<dd><p>Function for linear interpolation of transport coefficients. Modifies k_coeffs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<em>str</em>) – Possible values are ‘initial’ or ‘update’. The former should be used when
determining the initial definition.</p></li>
<li><p><strong>dependences</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – Possible values are ‘const’, ‘Umean’, ‘E/N’, ‘ESR’, or ‘Tgas’. Can also be
set to 0 to skip this k_coeff.</p></li>
<li><p><strong>N0</strong> (<em>float</em>) – Gas number density</p></li>
<li><p><strong>Tgas</strong> (<em>float</em>) – Gas temperature</p></li>
<li><p><strong>k_coeff</strong> (<em>List</em><em>[</em><em>df.Function</em><em>]</em>) – List of coefficient variables</p></li>
<li><p><strong>kx</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>) – Look-up table data</p></li>
<li><p><strong>ky</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>) – Look-up table data</p></li>
<li><p><strong>energy</strong> (<em>df.Function</em>) – Energy function</p></li>
<li><p><strong>redfield</strong> (<em>df.Function</em>) – Reduced electric field.</p></li>
<li><p><strong>mus</strong> (<em>List</em><em>[</em><em>df.Function</em><em>]</em><em>, </em><em>default None</em>) – Mobilities</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If given incorrect status or dependences, or if using ESR dependence without
    providing mus, or if the provided lists are not all of the same length.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.adaptive_solver">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">adaptive_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nonlinear_solver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PETScSNESSolver</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">NonlinearVariationalSolver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">problem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fedm.functions.Problem" title="fedm.functions.Problem"><span class="pre">Problem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expression</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expression</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_list_new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_list_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assigner</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FunctionAssigner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ttol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dependent_arguments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approximation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'LMEA'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#fedm.functions.adaptive_solver" title="Permalink to this definition">#</a></dt>
<dd><p>This function is used for solving the problem when adaptive time stepping is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nonlinear_solver</strong> (<em>Union</em><em>[</em><em>df.PETScSNESSolver</em><em>, </em><em>df.NonlinearVariationalSolver</em><em>]</em>) – The Dolfin solver to use.</p></li>
<li><p><strong>problem</strong> (<a class="reference internal" href="#fedm.functions.Problem" title="fedm.functions.Problem"><em>Problem</em></a>) – Nonlinear problem definition</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Time</p></li>
<li><p><strong>dt</strong> (<em>df.Expression</em>) – Time step size</p></li>
<li><p><strong>dt_old</strong> (<em>df.Expression</em>) – Previous time step size</p></li>
<li><p><strong>u_new</strong> (<em>df.Function</em>) – New variables defined on mixed function space</p></li>
<li><p><strong>u_old</strong> (<em>df.Function</em>) – Old variables defined on mixed function space</p></li>
<li><p><strong>var_list_new</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>) – List of new variables for postprocessing</p></li>
<li><p><strong>var_list_old</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>) – List of old variables for postprocessing</p></li>
<li><p><strong>assigner</strong> (<em>df.FunctionAssigner</em>) – Assigns values between variables</p></li>
<li><p><strong>error</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – Record of errors</p></li>
<li><p><strong>error_file</strong> (<em>Path</em>) – Error file name</p></li>
<li><p><strong>max_error</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – Maximum errors</p></li>
<li><p><strong>ttol</strong> (<em>float</em>) – Timestepping tolerance</p></li>
<li><p><strong>dt_min</strong> (<em>float</em>) – Minimum timestep allowed</p></li>
<li><p><strong>time_dependent_arguments</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em><em>, </em><em>default None</em>) – List of functions that need to be updated with time</p></li>
<li><p><strong>approximation</strong> (<em>str</em><em>, </em><em>default 'LMEA'</em>) – Type of approximation to use, options are ‘LMEA’ or ‘LFA’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The new time ‘t’</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>SystemExit</strong> – If the time step size is reduced below dt_min</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.adaptive_timestep">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">adaptive_timestep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.adaptive_timestep" title="Permalink to this definition">#</a></dt>
<dd><p>Function calculates new time step based on a PID controller M.  Moeller, Time
stepping  methods,  ATHENS  course: Introductioninto Finite Elements, Delft
Institute of Applied Mathematics, TU Delft(2015). Input arguments are time step,
error, tolerance for time step controller, minimal and maximal time step.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.adaptive_timestep_H211b">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">adaptive_timestep_H211b</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.adaptive_timestep_H211b" title="Permalink to this definition">#</a></dt>
<dd><p>Function calculates new time step size using H211b controller (G. Soederlind, Acm.
T. Math. Software 29: 1-26, 2003). Input arguments are time step size, previous time
step size, error, tolerance for time step controller, minimal and maximal time step.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.adaptive_timestep_PI34">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">adaptive_timestep_PI34</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fedm.functions.adaptive_timestep_PI34" title="Permalink to this definition">#</a></dt>
<dd><p>Function calculates new time step size using PI.3.4 controller (G. Soederlind
Numerical Algorithms 31: 281-310, 2002). Input arguments are time-step size, error,
tolerance for time step controller, minimal and maximal time-step size.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.modify_approximation_vars">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">modify_approximation_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">approximation_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_species</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_species</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.functions.modify_approximation_vars" title="Permalink to this definition">#</a></dt>
<dd><p>Depending on approximation used, the number of equations, charge and mass variables
are modified. Returns number species, number of equations, particle species,
masses, and charges. particle_species, masses, and charges may be modified.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.semi_implicit_coefficients">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">semi_implicit_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dependences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_energy_new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_energy_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Function</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficient_diffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Function</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Function</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fedm.functions.semi_implicit_coefficients" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.weak_form_Poisson_equation">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">weak_form_Poisson_equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15915494309189535</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Form</span></span></span><a class="headerlink" href="#fedm.functions.weak_form_Poisson_equation" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a weak form of Poisson equation. Input arguments are dV, trial function,
test function, source term and r coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dx</strong> (<em>df.Measure</em>) – dV, used to build integrals. Recommended to use dolfin.dx.</p></li>
<li><p><strong>u</strong> – Trial function</p></li>
<li><p><strong>v</strong> – Test function</p></li>
<li><p><strong>f</strong> – Source term</p></li>
<li><p><strong>r</strong> – r coordinate</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>df.Form</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.weak_form_balance_equation">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">weak_form_balance_equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expression</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expression</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Measure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_old1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.15915494309189535</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_representation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Form</span></span></span><a class="headerlink" href="#fedm.functions.weak_form_balance_equation" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the weak form of the particle balance equations.</p>
<p>If log_representation is True, solves:</p>
<div class="math notranslate nohighlight">
\[2 \pi \int_{\Omega}{} e^{u_\mathrm{k+1}}
\frac{1+2 \omega_k}{1 + \omega_k} \Bigl(
u_{k+1} - u_{k} \frac{1 + \omega_k^2}{1 + 2 \omega_k}
+ u_{k-2} \frac{\omega_k^2}{1 + 2 \omega_k})
\Bigr) \frac{v}{\Delta t_k} r \mathrm{d}x\]</div>
<p>otherwise, solves:</p>
<div class="math notranslate nohighlight">
\[2 \pi \int_{\Omega}{}
\frac{1+2 \omega_k}{1 + \omega_k} \Bigl(
u_{k+1} - u_{k} \frac{1 + \omega_k^2}{1 + 2 \omega_k}
+ u_{k-2} \frac{\omega_k^2}{1 + 2 \omega_k})
\Bigr) \frac{v}{\Delta t_k} r \mathrm{d}x\]</div>
<p>where <span class="math notranslate nohighlight">\(\omega_\mathrm{k} = \frac{\Delta t_\mathrm{k}}{\Delta t_\mathrm{k-1}}\)</span>.</p>
<p>If solving diffusion-reaction equation, also includes the term:</p>
<p>for log representation</p>
<div class="math notranslate nohighlight">
\[-2 \pi \int_{\Omega}{} (- \nabla(D_k e^u_{k+1}) \cdot \nabla v) r \mathrm{d}x\]</div>
<p>otherwise</p>
<div class="math notranslate nohighlight">
\[-2 \pi \int_{\Omega}{} (- \nabla(D_k u_{k+1}) \cdot \nabla v) r \mathrm{d}x\]</div>
<p>If solving drift-diffusion-reaction, instead includes the term:</p>
<div class="math notranslate nohighlight">
\[-2 \pi \int_{\Omega}{} \Gamma_{k+1} \cdot \nabla v r \mathrm{d}x\]</div>
<p>In all cases, also includes the source term:</p>
<div class="math notranslate nohighlight">
\[- 2 \pi \int_{\Omega}{} f v r \mathrm{d}x\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation_type</strong> (<em>str</em>) – Type of equation to solve. Options are ‘reaction’, ‘diffusion-reaction’, or
‘drift-diffusion-reaction’.</p></li>
<li><p><strong>dt</strong> (<em>df.Expression</em>) – Current time-step size</p></li>
<li><p><strong>dt_old</strong> (<em>df.Expression</em>) – Previous time-step size</p></li>
<li><p><strong>dx</strong> (<em>df.Measure</em>) – dV, used to build integrals. Recommended to use dolfin.dx.</p></li>
<li><p><strong>u</strong> – Trial function</p></li>
<li><p><strong>u_old</strong> – Value of variable in current time step</p></li>
<li><p><strong>u_old1</strong> – Value of variable in previous time step</p></li>
<li><p><strong>v</strong> – Test function</p></li>
<li><p><strong>f</strong> (<em>df.Function</em>) – Source term</p></li>
<li><p><strong>Gamma</strong> (<em>df.Function</em>) – particle flux</p></li>
<li><p><strong>r</strong> (<em>float</em><em>, </em><em>default 0.5 / pi</em>) – r coordinate</p></li>
<li><p><strong>D</strong> (<em>df.Function</em><em>, </em><em>default None</em>) – diffusion coefficient, only required for the diffusion equation.</p></li>
<li><p><strong>log_representation</strong> (<em>bool</em><em>, </em><em>default False</em>) – Use logarithmic representation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>df.Form</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If equation_type is not recognised, or if D is not supplied when solving the
    diffusion-reaction equation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.functions.weak_form_balance_equation_log_representation">
<span class="sig-prename descclassname"><span class="pre">fedm.functions.</span></span><span class="sig-name descname"><span class="pre">weak_form_balance_equation_log_representation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Form</span></span></span><a class="headerlink" href="#fedm.functions.weak_form_balance_equation_log_representation" title="Permalink to this definition">#</a></dt>
<dd><p>Convenience function, calls weak_form_balance_equation with log_representation set
to True.</p>
</dd></dl>

</section>
<section id="module-fedm.physical_constants">
<span id="fedm-physical-constants-module"></span><h2>fedm.physical_constants module<a class="headerlink" href="#module-fedm.physical_constants" title="Permalink to this heading">#</a></h2>
<p>This file collects physical constants used by other FEDM modules.</p>
</section>
<section id="module-fedm.utils">
<span id="fedm-utils-module"></span><h2>fedm.utils module<a class="headerlink" href="#module-fedm.utils" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fedm.utils.comma_separated">
<span class="sig-prename descclassname"><span class="pre">fedm.utils.</span></span><span class="sig-name descname"><span class="pre">comma_separated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fedm.utils.comma_separated" title="Permalink to this definition">#</a></dt>
<dd><p>Utility function, takes a list of strings and returns a single string containing
each of those strings in single quotes and separated by  ‘, ‘</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.utils.mesh_info">
<span class="sig-prename descclassname"><span class="pre">fedm.utils.</span></span><span class="sig-name descname"><span class="pre">mesh_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mesh</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fedm.utils.mesh_info" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fedm.utils.print_rank_0">
<span class="sig-prename descclassname"><span class="pre">fedm.utils.</span></span><span class="sig-name descname"><span class="pre">print_rank_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fedm.utils.print_rank_0" title="Permalink to this definition">#</a></dt>
<dd><p>Utility function, print to terminal if MPI rank 0, otherwise do nothing.</p>
</dd></dl>

</section>
<section id="module-fedm">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-fedm" title="Permalink to this heading">#</a></h2>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-fedm.file_io">fedm.file_io module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.Files"><code class="docutils literal notranslate"><span class="pre">Files</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.Files.error_file"><code class="docutils literal notranslate"><span class="pre">Files.error_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.Files.file_input"><code class="docutils literal notranslate"><span class="pre">Files.file_input</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.Files.model_log"><code class="docutils literal notranslate"><span class="pre">Files.model_log</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.Files.output_folder_path"><code class="docutils literal notranslate"><span class="pre">Files.output_folder_path</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.decomment"><code class="docutils literal notranslate"><span class="pre">decomment()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.file_output"><code class="docutils literal notranslate"><span class="pre">file_output()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.flatten"><code class="docutils literal notranslate"><span class="pre">flatten()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.flatten_float"><code class="docutils literal notranslate"><span class="pre">flatten_float()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.log"><code class="docutils literal notranslate"><span class="pre">log()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.mesh_statistics"><code class="docutils literal notranslate"><span class="pre">mesh_statistics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.no_convert"><code class="docutils literal notranslate"><span class="pre">no_convert()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.numpy_2d_array_to_str"><code class="docutils literal notranslate"><span class="pre">numpy_2d_array_to_str()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.output_files"><code class="docutils literal notranslate"><span class="pre">output_files()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.print_time"><code class="docutils literal notranslate"><span class="pre">print_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.print_time_step"><code class="docutils literal notranslate"><span class="pre">print_time_step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.rate_coefficient_file_names"><code class="docutils literal notranslate"><span class="pre">rate_coefficient_file_names()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.reaction_matrices"><code class="docutils literal notranslate"><span class="pre">reaction_matrices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_and_decomment"><code class="docutils literal notranslate"><span class="pre">read_and_decomment()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_dependence"><code class="docutils literal notranslate"><span class="pre">read_dependence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_dependences"><code class="docutils literal notranslate"><span class="pre">read_dependences()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_energy_loss"><code class="docutils literal notranslate"><span class="pre">read_energy_loss()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_particle_properties"><code class="docutils literal notranslate"><span class="pre">read_particle_properties()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_rate_coefficients"><code class="docutils literal notranslate"><span class="pre">read_rate_coefficients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_single_float"><code class="docutils literal notranslate"><span class="pre">read_single_float()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_single_string"><code class="docutils literal notranslate"><span class="pre">read_single_string()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_single_value"><code class="docutils literal notranslate"><span class="pre">read_single_value()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_speclist"><code class="docutils literal notranslate"><span class="pre">read_speclist()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_transport_coefficients"><code class="docutils literal notranslate"><span class="pre">read_transport_coefficients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.read_two_columns"><code class="docutils literal notranslate"><span class="pre">read_two_columns()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.file_io.truncate_file"><code class="docutils literal notranslate"><span class="pre">truncate_file()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-fedm.functions">fedm.functions module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.BoundaryGradient"><code class="docutils literal notranslate"><span class="pre">BoundaryGradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Boundary_flux"><code class="docutils literal notranslate"><span class="pre">Boundary_flux()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.CircleSubDomain"><code class="docutils literal notranslate"><span class="pre">CircleSubDomain</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.CircleSubDomain.inside"><code class="docutils literal notranslate"><span class="pre">CircleSubDomain.inside()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Energy_Source_term"><code class="docutils literal notranslate"><span class="pre">Energy_Source_term()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.ErrorGreaterThanTTOL"><code class="docutils literal notranslate"><span class="pre">ErrorGreaterThanTTOL</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Flux"><code class="docutils literal notranslate"><span class="pre">Flux()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Function_definition"><code class="docutils literal notranslate"><span class="pre">Function_definition()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Function_space_list"><code class="docutils literal notranslate"><span class="pre">Function_space_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.LineSubDomain"><code class="docutils literal notranslate"><span class="pre">LineSubDomain</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.LineSubDomain.inside"><code class="docutils literal notranslate"><span class="pre">LineSubDomain.inside()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Marking_boundaries"><code class="docutils literal notranslate"><span class="pre">Marking_boundaries()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Max"><code class="docutils literal notranslate"><span class="pre">Max()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Min"><code class="docutils literal notranslate"><span class="pre">Min()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Mixed_element_list"><code class="docutils literal notranslate"><span class="pre">Mixed_element_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Normal_vector"><code class="docutils literal notranslate"><span class="pre">Normal_vector()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Poisson_solver"><code class="docutils literal notranslate"><span class="pre">Poisson_solver()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Problem"><code class="docutils literal notranslate"><span class="pre">Problem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Problem.F"><code class="docutils literal notranslate"><span class="pre">Problem.F()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Problem.J"><code class="docutils literal notranslate"><span class="pre">Problem.J()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Rate_coefficient_interpolation"><code class="docutils literal notranslate"><span class="pre">Rate_coefficient_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Source_term"><code class="docutils literal notranslate"><span class="pre">Source_term()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.Transport_coefficient_interpolation"><code class="docutils literal notranslate"><span class="pre">Transport_coefficient_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.adaptive_solver"><code class="docutils literal notranslate"><span class="pre">adaptive_solver()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.adaptive_timestep"><code class="docutils literal notranslate"><span class="pre">adaptive_timestep()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.adaptive_timestep_H211b"><code class="docutils literal notranslate"><span class="pre">adaptive_timestep_H211b()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.adaptive_timestep_PI34"><code class="docutils literal notranslate"><span class="pre">adaptive_timestep_PI34()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.modify_approximation_vars"><code class="docutils literal notranslate"><span class="pre">modify_approximation_vars()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.semi_implicit_coefficients"><code class="docutils literal notranslate"><span class="pre">semi_implicit_coefficients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.weak_form_Poisson_equation"><code class="docutils literal notranslate"><span class="pre">weak_form_Poisson_equation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.weak_form_balance_equation"><code class="docutils literal notranslate"><span class="pre">weak_form_balance_equation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.functions.weak_form_balance_equation_log_representation"><code class="docutils literal notranslate"><span class="pre">weak_form_balance_equation_log_representation()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-fedm.physical_constants">fedm.physical_constants module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-fedm.utils">fedm.utils module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.utils.comma_separated"><code class="docutils literal notranslate"><span class="pre">comma_separated()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.utils.mesh_info"><code class="docutils literal notranslate"><span class="pre">mesh_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fedm.utils.print_rank_0"><code class="docutils literal notranslate"><span class="pre">print_rank_0()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-fedm">Module contents</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/fedm.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, Aleksandar P. Jovanović, Leibniz Institute for Plasma Science and Technology (INP).
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>